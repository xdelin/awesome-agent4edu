{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "discovery-tasks.json",
  "title": "Discovery Tasks Schema",
  "description": "Schema for defining parallel discovery workflow structure with agents and aggregation",
  "type": "object",
  "properties": {
    "phase": {
      "type": "string",
      "description": "The phase identifier for this discovery workflow",
      "enum": ["discovery-analysis"]
    },
    "parallel_agents": {
      "type": "array",
      "description": "List of agents that run in parallel during discovery",
      "minItems": 1,
      "items": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "description": "Unique identifier for the agent",
            "pattern": "^agent-[0-9]+[a-z]-[a-z]+(-[a-z]+)*$"
          },
          "description": {
            "type": "string",
            "description": "Human-readable description of what this agent discovers"
          },
          "critical": {
            "type": "boolean",
            "description": "Whether this agent's completion is critical for the workflow",
            "default": true
          },
          "subagent_id": {
            "type": "string",
            "description": "Identifier used to spawn or reference this subagent",
            "pattern": "^[0-9]+[a-z]-[a-z]+(-[a-z]+)*$"
          }
        },
        "required": ["id", "description", "critical", "subagent_id"],
        "additionalProperties": false
      }
    },
    "aggregation": {
      "type": "object",
      "description": "Configuration for the aggregation step that combines parallel results",
      "properties": {
        "description": {
          "type": "string",
          "description": "Human-readable description of the aggregation step"
        },
        "subagent_id": {
          "type": "string",
          "description": "Identifier for the aggregation subagent"
        }
      },
      "required": ["description", "subagent_id"],
      "additionalProperties": false
    }
  },
  "required": ["phase", "parallel_agents", "aggregation"],
  "additionalProperties": false,
  "default": {
    "phase": "discovery-analysis",
    "parallel_agents": [
      {
        "id": "agent-1a-language",
        "description": "Language & Manifest Discovery",
        "critical": true,
        "subagent_id": "1a-language"
      },
      {
        "id": "agent-1b-components",
        "description": "Component Discovery",
        "critical": false,
        "subagent_id": "1b-components"
      },
      {
        "id": "agent-1c-dependencies",
        "description": "Dependency Mapping",
        "critical": false,
        "subagent_id": "1c-dependencies"
      },
      {
        "id": "agent-1d-flows-apis",
        "description": "Flow & API Discovery",
        "critical": true,
        "subagent_id": "1d-flows-apis"
      }
    ],
    "aggregation": {
      "description": "Aggregate parallel analysis results",
      "subagent_id": "aggregation"
    }
  }
}
